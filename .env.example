# Postgres (Railway provides DATABASE_URL automatically after you attach a Postgres service)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/kalshi

# Polling settings
POLL_INTERVAL_SECONDS=300
MARKET_LIMIT=25
HISTORICAL_DAYS=7
HISTORICAL_MARKETS=10
RUN_HISTORICAL_BACKFILL_ON_START=true

# Kalshi client settings
# One-switch runtime mode:
# - custom: do not force any defaults
# - demo_safe: demo URLs + paper keys + conservative profile + auto paper trading
# - live_safe: production URLs + real keys + conservative profile + trading disabled
# - live_auto: production URLs + real keys + conservative profile + auto trading enabled
BOT_MODE=demo_safe
# Which key set to use (direct, paper, real). If omitted, BOT_MODE decides.
KALSHI_KEY_PROFILE=paper
KALSHI_STUB_MODE=false
KALSHI_BASE_URL=https://demo-api.kalshi.co
# Public data endpoints do not require auth. Keep false for data collection-only mode.
KALSHI_USE_AUTH_FOR_PUBLIC_DATA=false
# Optional async websocket runtime (Kalshi + exchange feeds). Keep false unless explicitly running async mode.
WEBSOCKET_ENABLED=false

# Direct key values (used when KALSHI_KEY_PROFILE=direct)
KALSHI_API_KEY_ID=
# Option A: put PEM contents directly (can include \n escapes)
KALSHI_API_KEY_SECRET=
# Option B: path to PEM on disk
KALSHI_PRIVATE_KEY_PATH=
KALSHI_PRIVATE_KEY_PASSWORD=

# Paper/demo key bundle (used when KALSHI_KEY_PROFILE=paper)
KALSHI_PAPER_API_KEY_ID=
KALSHI_PAPER_API_KEY_SECRET=
KALSHI_PAPER_PRIVATE_KEY_PATH=

# Real key bundle (used when KALSHI_KEY_PROFILE=real)
KALSHI_REAL_API_KEY_ID=
KALSHI_REAL_API_KEY_SECRET=
KALSHI_REAL_PRIVATE_KEY_PATH=

# Target only these Kalshi market themes for now.
# Format: semicolon-separated groups, each group is an AND-match on keywords.
TARGET_MARKET_QUERY_GROUPS=highest temperature in nyc today;bitcoin price up down 15 minutes
TARGET_MARKET_STATUS=open
TARGET_MARKET_DISCOVERY_PAGES=10
# Optional hard filters if you already know exact IDs.
# You can use tickers OR full market URLs (parser extracts ticker from URL):
TARGET_MARKET_TICKERS=
TARGET_EVENT_TICKERS=
TARGET_SERIES_TICKERS=KXHIGHNY,KXBTC15M
# If true, when tickers are not pinned:
# - select one live KXHIGHNY event (all brackets)
# - select nearest live KXBTC15M contract
AUTO_SELECT_LIVE_CONTRACTS=true

# Storage tuning
# false = only keep structured columns, true = also persist raw API JSON blobs
STORE_RAW_JSON=false

# Signal/data collectors
WEATHER_ENABLED=true
WEATHER_LATITUDE=40.7829
WEATHER_LONGITUDE=-73.9654
WEATHER_TIMEZONE=America/New_York
WEATHER_ENSEMBLE_MODELS=gfs_ensemble,ecmwf_ifs025_ensemble
WEATHER_FORECAST_DAYS=2

BTC_ENABLED=true
BTC_SYMBOL=BTCUSD
# Source collection order; include binance if your region can access it.
BTC_ENABLED_SOURCES=coinbase,kraken,bitstamp
# Core sources used for BTC signal fair-value composite.
BTC_CORE_SOURCES=coinbase,kraken,bitstamp
# Require this many core sources for BTC signal generation.
BTC_MIN_CORE_SOURCES=2
BTC_MOMENTUM_LOOKBACK_MINUTES=5
# Realtime BTC signal cadence (async runtime)
BTC_SIGNAL_INTERVAL_SECONDS=5

# Signal generation thresholds
# One knob for risk posture: conservative, balanced, aggressive
TRADING_PROFILE=conservative
# Explicit values below override TRADING_PROFILE defaults when set.
SIGNAL_MIN_EDGE_BPS=150
# true = keep all signals including "flat", false = keep only actionable signals
SIGNAL_STORE_ALL=true
BRACKET_ARB_ENABLED=true
BRACKET_ARB_MIN_PROFIT_AFTER_FEES_CENTS=1

# Paper trading (auto execution)
PAPER_TRADING_ENABLED=true
# simulate or kalshi_demo
PAPER_TRADING_MODE=kalshi_demo
PAPER_TRADING_BASE_URL=https://demo-api.kalshi.co
PAPER_TRADE_SIGNAL_TYPES=weather,btc
PAPER_TRADE_MIN_EDGE_BPS=200
PAPER_TRADE_MIN_CONFIDENCE=0.25
PAPER_TRADE_CONTRACT_COUNT=2
PAPER_TRADE_MAX_ORDERS_PER_CYCLE=2
PAPER_TRADE_COOLDOWN_MINUTES=30
PAPER_TRADE_MIN_PRICE_CENTS=5
PAPER_TRADE_MAX_PRICE_CENTS=95
PAPER_TRADE_MAKER_ONLY=true
PAPER_TRADE_ENABLE_ARBITRAGE=true
PAPER_TRADE_ENABLE_QUEUE_MANAGEMENT=true
PAPER_TRADE_QUEUE_MAX_DEPTH=50
PAPER_TRADE_QUEUE_STALE_MINUTES=10
PAPER_TRADE_REPRICE_COOLDOWN_MINUTES=20
PAPER_TRADE_REPRICE_MAX_PER_WINDOW=3
PAPER_TRADE_REPRICE_WINDOW_SECONDS=900
PAPER_TRADE_REPRICE_COOLDOWN_SECONDS=60
# fixed or kelly
PAPER_TRADE_SIZING_MODE=kelly
PAPER_TRADE_DEFAULT_FILL_PROBABILITY=0.5
PAPER_TRADE_FILL_PROB_LOOKBACK_DAYS=14
KELLY_FRACTION_SCALE=0.25
PAPER_TRADE_MAX_POSITION_DOLLARS=50
PAPER_TRADE_MAX_PORTFOLIO_EXPOSURE_DOLLARS=500

# Weather live-trading gates (checked before live weather execution)
WEATHER_LIVE_GATE_MIN_RESOLVED_DAYS=30
WEATHER_LIVE_GATE_MIN_BRIER_ADVANTAGE=0.005
WEATHER_LIVE_GATE_MIN_SIM_PROFIT_CENTS=0
WEATHER_LIVE_GATE_MAX_CALIBRATION_ERROR=0.15

# Telegram alerts
TELEGRAM_ENABLED=false
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=
TELEGRAM_NOTIFY_ACTIONABLE_ONLY=true
TELEGRAM_NOTIFY_EXECUTION_EVENTS=true
TELEGRAM_MIN_EDGE_BPS=150
EDGE_DECAY_ALERT_THRESHOLD_BPS=75
